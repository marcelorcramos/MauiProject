<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:Maui_1.ViewModel"
             xmlns:m="clr-namespace:Maui_1.Model"
             x:DataType="{x:Type vm:PessoaVM}"
             x:Class="Maui_1.View.Page_Pessoas"
             Padding="12"
             Title="Page_Pessoas">
    <ContentPage.Resources>
        <Style TargetType="Border">
            <Setter Property="Stroke" Value="Black"/>
            <Setter Property="Padding" Value="12"/>
            <Setter Property="StrokeShape" Value="RoundRectangle 12"/>
        </Style>
    </ContentPage.Resources>
    <Grid RowDefinitions="auto,auto,*">
        <Border>
            <VerticalStackLayout>
                <Label Text="Pessoa Ativa"/>
                <Entry IsReadOnly="True" Text="{Binding Pessoacur.Id}" Placeholder="Id"/>
                <Entry Text="{Binding Pessoacur.Nome, Mode=TwoWay}" Placeholder="Introduza Nome"/>
                <Entry Keyboard="Telephone" Text="{Binding Pessoacur.Telefone, Mode=TwoWay }" Placeholder="Introduza Telefone"/>
                <Button Command="{Binding SalvarPessoaCommand}"  Text="Guardar" BackgroundColor="Black"/>
            </VerticalStackLayout>
        </Border>
        <Label HorizontalTextAlignment="Center" Margin="12" Text="Lista de Pessoas" Grid.Row="1"/>
        <CollectionView Grid.Row="2" ItemsSource="{Binding Pessoas}">
            <CollectionView.EmptyView>
                <Border>
                    <VerticalStackLayout>
                        <Label Text="Lista Vazia"/>
                    </VerticalStackLayout>
                </Border>
            </CollectionView.EmptyView>
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="3"/>
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="{x:Type m:Pessoa}">
                    <Border>
                    <SwipeView MinimumHeightRequest="40">
                        <SwipeView.RightItems>
                            <SwipeItems>
                                <SwipeItem
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type vm:PessoaVM}},Path=SetPessoasCurCommand}"
                                    CommandParameter="{Binding .}"
                                    Text="✎" BackgroundColor="Green"/>
                                <SwipeItem 
                                    Command="{Binding Source={RelativeSource AncestorType={x:Type vm:PessoaVM}},Path=DeletePessoaCommand}"
                                    CommandParameter="{Binding .}"
                                    Text="🗑" BackgroundColor="Red"/>
                                <SwipeItem Text="☏" BackgroundColor="Yellow"/>
                            </SwipeItems>
                        </SwipeView.RightItems>
                        <VerticalStackLayout>
                            <Label >
                                <Label.Text>
                                    <MultiBinding StringFormat="reg: {0} {1} tlf:{2}">
                                        <Binding Path="Id"/>
                                        <Binding Path="Nome"/>
                                        <Binding Path="Telefone"/>
                                    </MultiBinding>
                                </Label.Text>
                            </Label>
                            </VerticalStackLayout>
                        </SwipeView>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>